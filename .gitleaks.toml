# Gitleaks configuration for home-infra
# https://github.com/gitleaks/gitleaks

title = "gitleaks config for home-infra"

[extend]
# useDefault will extend the base configuration with the default gitleaks config
# https://github.com/gitleaks/gitleaks/blob/master/config/gitleaks.toml
useDefault = true

[[allowlists]]
description = "Global git-crypt allowlist"
paths = [
  '''.*\.secrets\.auto\.tfvars$''',
  '''packer/.*/\.env$''',
  '''terraform/.*/\.env$''',
  '''backend\.config$''',
  '''sensitive\/.*$''',
]

[[rules]]
id = "generic-api-key"
[[rules.allowlists]]
condition = "AND"
# Allow Sealed Secrets or similar large base64-encoded blobs (e.g., Kubernetes SealedSecret encrypted data)
regexes = ['''Ag[a-zA-Z0-9+/]{500,}={0,2}''']
paths = ['''(?i).*\.ya?ml$''']
description = "Allow large base64-encoded blobs in YAML files"
